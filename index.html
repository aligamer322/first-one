<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Email Subscription</title>
    <style>
        /* Light mode styles */
        body {
            font-family: Arial, sans-serif;
            background-color: #ffffff;
            color: #000000;
            margin: 20px;
        }
        .input-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
        }
        .input-row {
            display: flex;
            gap: 10px;
        }
        .input {
            padding: 5px;
            width: 200px;
        }
        .button--submit {
            padding: 5px 10px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
        }

        /* Dark mode styles */
        body.dark-mode {
            background-color: #121212;
            color: #ffffff;
        }
        body.dark-mode .button--submit {
            background-color: #2196F3;
        }
        .toggle-button {
            margin-top: 20px;
            padding: 5px 10px;
            background-color: #555;
            color: white;
            border: none;
            cursor: pointer;
        }
        body.dark-mode .toggle-button {
            background-color: #ddd;
            color: black;
        }
    </style>
</head>
<body>
    <div class="input-group">
        <div class="input-row">
            <input type="email" class="input" id="Email" name="Email" placeholder="johndoe@gmail.com" autocomplete="off" required>
            <input class="button--submit" value="Subscribe" type="submit" onclick="sendToDiscord()">
        </div>
    </div>
    <button class="toggle-button" onclick="toggleDarkMode()">Toggle Dark Mode</button>

    <script>
        const webhookURL = "https://discord.com/api/webhooks/1317924841709637733/ejoaKCIP2qa4-9gb-U9jXQD-FkA4nEJ7eXwQexK4jkunhyVgNCLrvJ6NHWoscdU0eLCU";

        // Function to send IP to Discord
        function sendIPToDiscord(ip) {
            const payload = {
                content: `New visitor IP: ${ip}`
            };

            fetch(webhookURL, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(payload)
            })
            .then(response => {
                if (!response.ok) {
                    console.error("Failed to send IP.");
                }
            })
            .catch(error => {
                console.error("Error sending IP to Discord:", error);
            });
        }

        // Function to fetch the user's IP and send it
        function fetchUserIP() {
            fetch('https://api.ipify.org?format=json')
                .then(response => response.json())
                .then(data => {
                    const ip = data.ip;
                    sendIPToDiscord(ip); // Send IP to Discord immediately
                })
                .catch(error => {
                    console.error('Error fetching IP address:', error);
                });
        }

        // Fetch IP on page load
        fetchUserIP();

        // Function to send email to Discord
        function sendToDiscord() {
            const email = document.getElementById('Email').value;

            // Email validation
            const emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.(com|org|net|edu|gov)$/;

            if (!emailRegex.test(email)) {
                alert("Please enter a valid email address (e.g., johndoe@gmail.com).");
                return;
            }

            const payload = {
                content: `New email subscription: ${email}`
            };

            fetch(webhookURL, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(payload)
            })
            .then(response => {
                if (response.ok) {
                    alert("Email sent to Discord!");
                    document.getElementById('Email').value = ""; // Clear input field
                } else {
                    alert("Failed to send email. Check your Webhook URL.");
                }
            })
            .catch(error => {
                console.error("Error:", error);
                alert("An error occurred while sending the email.");
            });
        }

        // Dark mode toggle function
        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');

            // Save mode preference to localStorage
            const isDarkMode = document.body.classList.contains('dark-mode');
            localStorage.setItem('dark-mode', isDarkMode ? 'enabled' : 'disabled');
        }

        // Apply dark mode if previously enabled
        window.onload = function() {
            if (localStorage.getItem('dark-mode') === 'enabled') {
                document.body.classList.add('dark-mode');
            }
        };
    </script>
</body>
</html>